{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\naxios.defaults.baseURL = 'https://pixabay.com/api/';\nconst params = {\n    key: '49331569-d75c2214014d7ff2c794993e6',\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n}\n\nexport default function searchRequest(searchData, pageNumber = 1, pageSize = 15) {\n    params.q = searchData;\n    params.page = pageNumber;\n    params.per_page = pageSize;\n    return axios.get('', { params });\n}\n\n","\nexport function renderData(data, options) {\n    const galleryCollectionTemplate = [];\n    data.forEach(item => {\n        galleryCollectionTemplate.push(\n            `<li>\n                <a class=\"gallery-link\" href=\"${item.largeImageURL}\">\n                    <img src=\"${item.previewURL}\" alt=\"${item.tags}\">\n                    <ul>\n                        <li>\n                            <p>Likes: <span>${item.likes}</span></p>\n                        </li>\n                        <li>\n                            <p>Views: <span>${item.views}</span></p>\n                        </li>\n                        <li>\n                            <p>Comments: <span>${item.comments}</span></p>\n                        </li>\n                        <li>\n                            <p>Downloads: <span>${item.downloads}</span></p>\n                        </li>\n                    </ul>\n                </a>\n            </li>`\n        );\n    });\n    options.gallery.insertAdjacentHTML('beforeend', galleryCollectionTemplate.join(''));\n    options.lightbox.refresh();\n    if (options.isPaging) {\n        galleryScroll(options.gallery.querySelector(\".gallery-link\").getBoundingClientRect().height * 2);\n    }\n}\n\nfunction galleryScroll(scrollBy) { \n    window.scrollBy({ top: scrollBy, left: 0, behavior: \"smooth\" });\n}\n\nexport function clearGallery(gallery) { \n    gallery.innerHTML = '';\n}","//#region imports\nimport fetchData from './js/pixabay-api';\nimport {renderData, clearGallery} from './js/render-functions';\n\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n//#endregion imports\n\n//#region init variables and options\nconst searchInput = document.querySelector('input[name=\"search-text\"]');\nconst searchButton = document.querySelector('button[type=\"submit\"]');\nconst gallery = document.querySelector('.gallery');\nconst loadingMessage = document.querySelector('.loading');\nconst loadMoreButton = document.querySelector('.load-more-button');\nconst endOfSearchMessage = document.querySelector('.end-of-search');\nconst backToTopButton = document.querySelector('.back-to-top');\n\nconst iziToastNoInputSettings = {\n    theme: 'dark',\n    backgroundColor: '#EF4040',\n    position: 'topRight',\n    messageColor: '#FAFAFB',\n    message: 'Please enter search terms',\n    iconUrl: './error-alert.svg',\n    iconColor: 'white',\n    messageSize: '16px',\n    messageLineHeight: '24px',\n    progressBarColor: '#B51B1B'\n}\n\nconst iziToastNoImageSettings = {\n    theme: 'dark',\n    backgroundColor: '#EF4040',\n    position: 'topRight',\n    messageColor: '#FAFAFB',\n    message: 'No images found, try again',\n    iconUrl: './error-alert.svg',\n    iconColor: 'white',\n    messageSize: '16px',\n    messageLineHeight: '24px',\n    progressBarColor: '#B51B1B'\n}\n\nconst lightboxOptions = {\n    captionsData: 'alt',\n    captionDelay: 250\n}\n\nconst lightboxGallery = new SimpleLightbox('.gallery a', { ...lightboxOptions });\n\nconst renderOptions = {\n    gallery: gallery,\n    lightbox: lightboxGallery,\n    isPaging: false\n}\n\nlet page = 1;\nconst itemsPerPage = 15;\nlet totalPages;\nlet searchData = searchInput.value;\nlet loadData;\n//#endregion init variables and options\n\n//#region utils\nfunction calcPages(totalElements) {\n    totalPages = Math.floor(totalElements / itemsPerPage);\n}\n\nfunction iteratePage() {\n    page++;\n}\n\nfunction resetPages() {\n    page = 1;\n}\nfunction isLastPage() {\n    return totalPages < page; \n}\n //#endregion utils\n\n //#region event listeners\nsearchButton.addEventListener('click', async (e) => {\n    e.preventDefault();\n    clearGallery(gallery);\n    resetPages();\n    endOfSearchMessage.classList.add('visually-hidden');\n    loadMoreButton.classList.add('visually-hidden');\n    if (!searchData || searchData === '') {\n        iziToast.show({ ...iziToastNoInputSettings });\n        return;\n    }\n    loadingMessage.classList.remove('visually-hidden'); //deleting and adding element might be better? rethink\n    await fetchData(searchData, page, itemsPerPage)\n        .then((response) => {\n            loadingMessage.classList.add('visually-hidden');\n            if (response.data.totalHits > 0) {\n                renderOptions.isPaging = false;\n                renderData(response.data.hits, renderOptions);\n                calcPages(response.data.totalHits);\n                if (!isLastPage()) {\n                    renderOptions.isPaging = true;\n                    iteratePage();\n                    loadMoreButton.classList.remove('visually-hidden');\n                    loadData = searchData;\n                }\n                else {\n                    endOfSearchMessage.classList.remove('visually-hidden');\n                }\n            }\n            else {\n                iziToast.show({ ...iziToastNoImageSettings });\n            }\n        })\n        .catch((error) => {\n            loadingMessage.classList.add('visually-hidden');\n            console.error('Error:', error);\n            iziToast.error({title: 'Error', message:'Error fetching results, try again later (check console for details)'});\n        });\n});\n\nloadMoreButton.addEventListener('click', async (e) => { \n    e.preventDefault();\n    loadMoreButton.classList.add('visually-hidden');\n    await fetchData(loadData, page, itemsPerPage)\n        .then((response) => {\n            loadingMessage.classList.add('visually-hidden');\n            if (response.data.totalHits > 0) {\n                renderData(response.data.hits, renderOptions);\n                if (!isLastPage()) {\n                    iteratePage();\n                    loadMoreButton.classList.remove('visually-hidden');\n                }\n                else {\n                    loadMoreButton.classList.add('visually-hidden');\n                    endOfSearchMessage.classList.remove('visually-hidden');\n                }\n            }\n        })\n        .catch((error) => {\n            loadingMessage.classList.add('visually-hidden');\n            console.error('Error:', error);\n            iziToast.error({title: 'Error', message:'Error fetching results, try again later (check console for details)'});\n        });\n})\n\nbackToTopButton.addEventListener('click', (e) => {\n    e.preventDefault();\n    window.scrollTo(0, 0);\n})\n\nsearchInput.addEventListener('input', () => searchData = searchInput.value.trim());\n//#endregion event listeners\n"],"names":["axios","params","searchRequest","searchData","pageNumber","pageSize","renderData","data","options","galleryCollectionTemplate","item","galleryScroll","scrollBy","clearGallery","gallery","searchInput","searchButton","loadingMessage","loadMoreButton","endOfSearchMessage","backToTopButton","iziToastNoInputSettings","iziToastNoImageSettings","lightboxOptions","lightboxGallery","SimpleLightbox","renderOptions","page","itemsPerPage","totalPages","loadData","calcPages","totalElements","iteratePage","resetPages","isLastPage","e","iziToast","fetchData","response","error"],"mappings":"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"}